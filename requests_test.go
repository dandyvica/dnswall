package main

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestGetDomainName(t *testing.T) {
	assert := assert.New(t)

	// a query taken from Wireshark
	buffer := []byte{0x30, 0x5c, 0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x77, 0x77, 0x77, 0x06, 0x67, 0x6f, 0x6f, 0x67, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d, 0x00, 0x00, 0x01, 0x000, 0x01}
	options := new(CliOptions)
	domain, _ := GetDomainQuestion(buffer, options)

	assert.Equal(domain.Domain, "www.google.com.")
	assert.Equal(domain.QType, uint16(1))
}
